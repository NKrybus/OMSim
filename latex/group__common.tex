\hypertarget{group__common}{}\doxysection{OMSim framework and geometry}
\label{group__common}\index{OMSim framework and geometry@{OMSim framework and geometry}}


These files define the geometry and materials common to all studies.  




\doxysubsection{Detailed Description}
\hypertarget{group__common_framework}{}\doxysubsubsection{OMSim framework}\label{group__common_framework}
\hypertarget{group__common_data}{}\doxyparagraph{Materials and User Data}\label{group__common_data}
User-\/defined material data are stored in JSON files under /common/data to minimize file length (the original detector construction had over 4,000 lines, mainly due to material properties!). The \mbox{\hyperlink{class_input_data_manager}{Input\+Data\+Manager}} (\mbox{\hyperlink{_o_m_sim_input_data_8hh}{OMSim\+Input\+Data.\+hh}}) loads these properties into the Geant4 framework. They can be retrieved using the \mbox{\hyperlink{class_input_data_manager_a05b5637e4b31dbaaede67d40a139528e}{Input\+Data\+Manager\+::get\+Material}} and \mbox{\hyperlink{class_input_data_manager_ae6ae987535a442a42ad47d53394ade56}{Input\+Data\+Manager\+::get\+Optical\+Surface}} methods. Since different materials have various properties, the data is loaded in multiple ways. These different material types are defined in \mbox{\hyperlink{_o_m_sim_data_file_types_8hh}{OMSim\+Data\+File\+Types.\+hh}}. Additionally, geometry data for the PMTs are also stored in JSON files. These are parsed directly into a \char`\"{}tree\char`\"{} (essentially a dictionary containing the JSON file\textquotesingle{}s keys and values). This method was adopted because various PMTs are constructed similarly, eliminating the need to define a unique class for each PMT type, as is done for the optical modules.

If you wish to load additional data, you can either define a new type in OMSim\+Data\+File\+Types or load it into a tree as previously mentioned. For simpler tasks, use the static method \mbox{\hyperlink{class_input_data_manager_a3a233522b61c65875ebb7b274ff31507}{Input\+Data\+Manager\+::loadtxt}}, which operates similarly to Python\textquotesingle{}s numpy.\+loadtxt. For example\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{std::vector<G4PV2DDataVector> data = \mbox{\hyperlink{class_input_data_manager_a3a233522b61c65875ebb7b274ff31507}{InputDataManager::loadtxt}}(\textcolor{stringliteral}{"{}path/file\_name.txt"{}});}
\DoxyCodeLine{std::vector<G4double> first\_column = data.at(0);}
\DoxyCodeLine{std::vector<G4double> second\_column = data.at(1);}
\DoxyCodeLine{\textcolor{comment}{// ...}}

\end{DoxyCode}
\hypertarget{group__common_geometry}{}\doxyparagraph{Geometry}\label{group__common_geometry}
Each optical module and harness is defined in its respective class, located in the /common/optical\+\_\+modules/ folder. These inherit from the virtual base class \mbox{\hyperlink{class_optical_module}{Optical\+Module}}. This inheritance ensures the definition of functions to retrieve the pressure vessel\textquotesingle{}s weight (necessary for radioactive decay studies) and the count of PMTs inside the module. The \mbox{\hyperlink{class_optical_module}{Optical\+Module}} interface inherits from \mbox{\hyperlink{classabc_detector_component}{abc\+Detector\+Component}}, a general helper class simplifying construction. Most \mbox{\hyperlink{class_o_m_sim}{OMSim}} geometries inherit from this class, as illustrated in the dependency diagram below\+:  The \mbox{\hyperlink{class_o_m_sim_p_m_t_construction}{OMSim\+PMTConstruction}} in /common/framework constructs PMTs. There are two PMT construction types. The first is simple, with a solid photocathode where all entering photons are recorded. The second type simulates the photocathode as a thin layer, also representing the internal components. For more information, refer to Chapter 9 of \href{https://zenodo.org/record/8121321}{\texttt{ Martin Unland\textquotesingle{}s thesis}}. Each PMT model\textquotesingle{}s construction is quite similar. However, the frontal window shape varies among models, leading to diverse combinations of ellipsoids and spheres.

   ~\newline
 Figure 1\+: {\itshape Cross section of simple \mbox{\hyperlink{classm_d_o_m}{m\+DOM}} PMT model. Image from \href{https://zenodo.org/record/8121321}{\texttt{ M. Unland\textquotesingle{}s thesis}}.}  

   ~\newline
 Figure 1\+: {\itshape Side view of complex \mbox{\hyperlink{classm_d_o_m}{m\+DOM}} PMT model. Image from \href{https://zenodo.org/record/8121321}{\texttt{ M. Unland\textquotesingle{}s thesis}}.}  

In the complex PMT model the photocathode has an absorption length that matches the measured quantum efficiency of the \mbox{\hyperlink{classm_d_o_m}{m\+DOM}} PMTs. For the other PMT models this matching has to be still be performed.

   ~\newline
 Figure 3\+: {\itshape QE of simulation with the absorption length currently used compared to measurements. Image from \href{https://zenodo.org/record/8121321}{\texttt{ M. Unland\textquotesingle{}s thesis}}.}  \hypertarget{group__common_response}{}\doxyparagraph{PMT response}\label{group__common_response}
\begin{DoxyWarning}{Warning}
Detailed PMT response currently only for \mbox{\hyperlink{classm_d_o_m}{m\+DOM}} PMT
\end{DoxyWarning}
The class \mbox{\hyperlink{class_o_m_sim_p_m_t_response}{OMSim\+PMTResponse}} provides a realistic PMT response (charge and transit time) using the measured scans from \href{https://zenodo.org/record/8121321}{\texttt{ M. Unland\textquotesingle{}s thesis}}. To turn on this feature, the bool-\/switch command line argument \char`\"{}pmt\+\_\+response\char`\"{} has to be given. For more information see Section 9.\+3.\+4 of the thesis.

   ~\newline
 Figure 4\+: {\itshape PMT response compared to measurement for different light sources. Image from \href{https://zenodo.org/record/8121321}{\texttt{ M. Unland\textquotesingle{}s thesis}}.}   \doxysubsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \mbox{\hyperlink{abc_detector_component_8hh}{abc\+Detector\+Component.\+hh}}
\begin{DoxyCompactList}\small\item\em Provides helper base class \mbox{\hyperlink{classabc_detector_component}{abc\+Detector\+Component}} for constructing and managing detector components in \mbox{\hyperlink{class_o_m_sim}{OMSim}}. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_8hh}{OMSim.\+hh}}
\begin{DoxyCompactList}\small\item\em Main simulation class for the Optical Module (OM) simulation. This file defines the \mbox{\hyperlink{class_o_m_sim}{OMSim}} class, which controls the entire simulation process in all studies and includes the general program options. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_command_args_table_8hh}{OMSim\+Command\+Args\+Table.\+hh}}
\begin{DoxyCompactList}\small\item\em Definition of the \mbox{\hyperlink{class_o_m_sim_command_args_table}{OMSim\+Command\+Args\+Table}} singleton class, which controls user args. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_data_file_types_8hh}{OMSim\+Data\+File\+Types.\+hh}}
\begin{DoxyCompactList}\small\item\em Collection of classes and methods to handle material creation from user data in json files. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_hit_manager_8hh}{OMSim\+Hit\+Manager.\+hh}}
\begin{DoxyCompactList}\small\item\em Defines structures and classes related to optical module photon hit management. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_p_m_t_response_8hh}{OMSim\+PMTResponse.\+hh}}
\begin{DoxyCompactList}\small\item\em Provides simulation for PMT response. This class is responsible for transforming hits on photocathode into pulses, with transit time, charge, and detection probability. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_u_iinterface_8hh}{OMSim\+UIinterface.\+hh}}
\begin{DoxyCompactList}\small\item\em The \mbox{\hyperlink{class_o_m_sim_u_iinterface}{OMSim\+UIinterface}} class provides a singleton interface to Geant4\textquotesingle{}s UI manager. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_8cc}{OMSim.\+cc}}
\begin{DoxyCompactList}\small\item\em Implementation of the \mbox{\hyperlink{class_o_m_sim}{OMSim}} class. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_d_e_g_g_8hh}{OMSim\+DEGG.\+hh}}
\begin{DoxyCompactList}\small\item\em Construction of the \mbox{\hyperlink{class_d_e_g_g}{DEGG}} class. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_d_e_g_g_harness_8hh}{OMSim\+DEGGHarness.\+hh}}
\begin{DoxyCompactList}\small\item\em Construction of the \mbox{\hyperlink{class_d_e_g_g}{DEGG}} harness. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_l_o_m16_8hh}{OMSim\+LOM16.\+hh}}
\begin{DoxyCompactList}\small\item\em Construction of \mbox{\hyperlink{class_l_o_m16}{LOM16}}. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_l_o_m18_8hh}{OMSim\+LOM18.\+hh}}
\begin{DoxyCompactList}\small\item\em Construction of \mbox{\hyperlink{class_l_o_m18}{LOM18}}. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_m_d_o_m_8hh}{OMSim\+MDOM.\+hh}}
\begin{DoxyCompactList}\small\item\em Construction of \mbox{\hyperlink{classm_d_o_m}{m\+DOM}}. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_m_d_o_m_flasher_8hh}{OMSim\+MDOMFlasher.\+hh}}
\begin{DoxyCompactList}\small\item\em Defines the \mbox{\hyperlink{classm_d_o_m_flasher}{m\+DOMFlasher}} class for simulating the 10 flashers in an \mbox{\hyperlink{classm_d_o_m}{m\+DOM}} optical module. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_m_d_o_m_harness_8hh}{OMSim\+MDOMHarness.\+hh}}
\begin{DoxyCompactList}\small\item\em Construction of \mbox{\hyperlink{classm_d_o_m}{m\+DOM}} harness. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{_o_m_sim_p_d_o_m_8hh}{OMSim\+PDOM.\+hh}}
\begin{DoxyCompactList}\small\item\em Implementation of the p\+DOM/\+Gen1 DOM class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classabc_detector_component}{abc\+Detector\+Component}}
\begin{DoxyCompactList}\small\item\em Abstract base class used for constructing detector components. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_o_m_sim}{OMSim}}
\begin{DoxyCompactList}\small\item\em Controls the main simulation process. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_o_m_sim_command_args_table}{OMSim\+Command\+Args\+Table}}
\begin{DoxyCompactList}\small\item\em A singleton class used to hold and manipulate \mbox{\hyperlink{class_o_m_sim}{OMSim}} command arguments. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classabc_data_file}{abc\+Data\+File}}
\begin{DoxyCompactList}\small\item\em This is an abstract base class that provides an interface for handling data files in the simulation. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classabc_material_data}{abc\+Material\+Data}}
\begin{DoxyCompactList}\small\item\em Abstract base class for material data extraction from a json file. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_refraction_and_absorption}{Refraction\+And\+Absorption}}
\begin{DoxyCompactList}\small\item\em This class is responsible for handling materials with both a defined refractive index and absorption length. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_refraction_only}{Refraction\+Only}}
\begin{DoxyCompactList}\small\item\em This class is responsible for handling materials with only defined refractive index. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_no_optics}{No\+Optics}}
\begin{DoxyCompactList}\small\item\em This class is responsible for handling materials without defined optical properties. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_ice_cube_ice}{Ice\+Cube\+Ice}}
\begin{DoxyCompactList}\small\item\em This class is responsible for the creation and property extraction of Ice\+Cube\textquotesingle{}s ice. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_reflective_surface}{Reflective\+Surface}}
\begin{DoxyCompactList}\small\item\em This class is responsible for defining new reflective surfaces using data parsed from a JSON file. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{struct_hit_stats}{Hit\+Stats}}
\begin{DoxyCompactList}\small\item\em A structure to store information about detected photon hits. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_o_m_sim_hit_manager}{OMSim\+Hit\+Manager}}
\begin{DoxyCompactList}\small\item\em Manages detected photon information. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_o_m_sim_u_iinterface}{OMSim\+UIinterface}}
\begin{DoxyCompactList}\small\item\em Singleton interface to Geant4\textquotesingle{}s UI manager. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_d_e_g_g}{DEGG}}
\begin{DoxyCompactList}\small\item\em Construction of the \mbox{\hyperlink{class_d_e_g_g}{DEGG}} detector geometry. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classm_d_o_m_flasher}{m\+DOMFlasher}}
\begin{DoxyCompactList}\small\item\em The \mbox{\hyperlink{classm_d_o_m_flasher}{m\+DOMFlasher}} class represents the 10 flashers in an \mbox{\hyperlink{classm_d_o_m}{m\+DOM}} optical module. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{class_optical_module}{Optical\+Module}}
\begin{DoxyCompactList}\small\item\em Base class for OMs works as interface. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classp_d_o_m}{p\+DOM}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classp_d_o_m}{p\+DOM}} class represents the construction of p\+DOM/\+Gen1 DOM. \end{DoxyCompactList}\end{DoxyCompactItemize}
