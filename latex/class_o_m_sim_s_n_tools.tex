\hypertarget{class_o_m_sim_s_n_tools}{}\doxysection{OMSim\+SNTools Class Reference}
\label{class_o_m_sim_s_n_tools}\index{OMSimSNTools@{OMSimSNTools}}


Provides utility methods for generating ENES and IBD interactions.  




\doxysubsection{Detailed Description}
This class serves as a repository for common functionalities associated with the generation of ENES and IBD interactions within the Supernova (SN) context. \doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_o_m_sim_s_n_tools_ab44ce4494361d6352987b74c252af450}{OMSim\+SNTools}} ()
\item 
\mbox{\hyperlink{class_o_m_sim_s_n_tools_aa8369c8d49524201977f48fa5eb20f48}{$\sim$\+OMSim\+SNTools}} ()
\item 
G4\+Three\+Vector \mbox{\hyperlink{class_o_m_sim_s_n_tools_a7e746f08979e8ead130088b7396871a1}{random\+Position}} ()
\begin{DoxyCompactList}\small\item\em Randomly determines a vertex position within the generation volume. \end{DoxyCompactList}\item 
std\+::pair$<$ std\+::string, std\+::string $>$ \mbox{\hyperlink{class_o_m_sim_s_n_tools_a89a22f20d0aff91704cf6cab1b48d266}{get\+File\+Names}} (int value)
\begin{DoxyCompactList}\small\item\em Retrieves file names for neutrino and antineutrino fluxes based on a specified supernova model. \end{DoxyCompactList}\item 
G4double \mbox{\hyperlink{class_o_m_sim_s_n_tools_afe3ad7c2e7664ff456a98e13b394d17d}{sample\+Value\+From\+Distribution}} (std\+::vector$<$ G4double $>$ xvals, std\+::vector$<$ G4double $>$ yvals, G4int n\+Points)
\begin{DoxyCompactList}\small\item\em Samples a value from a given distribution using the Inverse CDF method. \end{DoxyCompactList}\item 
G4double \mbox{\hyperlink{class_o_m_sim_s_n_tools_a82b3eb18b59eba3907a73216050ca5a5}{inverse\+CDFmethod}} (const std\+::vector$<$ G4double $>$ \&pX, const std\+::vector$<$ G4double $>$ \&pY, const std\+::vector$<$ G4double $>$ \&p\+Slopes, const std\+::vector$<$ G4double $>$ \&p\+CDF)
\begin{DoxyCompactList}\small\item\em Samples values from a given distribution using the Inverse CDF algorithm. \end{DoxyCompactList}\item 
G4int \mbox{\hyperlink{class_o_m_sim_s_n_tools_a704058ea142089a962a89b3dae706aa8}{find\+Time}} (G4double time, std\+::vector$<$ G4double $>$ timearray)
\begin{DoxyCompactList}\small\item\em Finds the nearest (or next largest) value in an array to a specified input. \end{DoxyCompactList}\item 
G4double \mbox{\hyperlink{class_o_m_sim_s_n_tools_a48caade81da87bfc2a0ac9da94b57110}{sample\+Energy}} (G4double Emean, G4double Emean2, G4double \&alpha)
\begin{DoxyCompactList}\small\item\em Determines the energy value using the inverse cumulative algorithm based on a given distribution. \end{DoxyCompactList}\item 
G4double \mbox{\hyperlink{class_o_m_sim_s_n_tools_a86811883d92fdbaf0627b85fde379c43}{linear\+Interpolation}} (G4double x, G4double x1, G4double x2, G4double y1, G4double y2)
\begin{DoxyCompactList}\small\item\em Performs linear interpolation between two points. \end{DoxyCompactList}\item 
G4double \mbox{\hyperlink{class_o_m_sim_s_n_tools_aeb59462c439834b0bb9c5a5be3ad612c}{get\+Alpha}} (G4double Emean, G4double Emean2)
\begin{DoxyCompactList}\small\item\em Calculates pinching parameter of energy spectrum. \end{DoxyCompactList}\item 
G4double \mbox{\hyperlink{class_o_m_sim_s_n_tools_a518a596145fbc96c4cfe153e60bd7f7e}{weight}} (G4double sigma, G4double NTargets)
\begin{DoxyCompactList}\small\item\em Calculates the interaction weight based on the cross section and number of targets. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{class_o_m_sim_s_n_tools_a0b663ee3b96216ee943a681a496dffc5}{check\+Volume\+For\+OMs}} (G4\+Three\+Vector position)
\begin{DoxyCompactList}\small\item\em Checks if a given position is within any of the modules. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ G4double $>$ \mbox{\hyperlink{class_o_m_sim_s_n_tools_a9b417d3b2e85de4f1b20e09497a63922}{mdompos}}
\item 
G4double \mbox{\hyperlink{class_o_m_sim_s_n_tools_af908be289d086253893f327f7463d793}{Rmin}}
\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_ab44ce4494361d6352987b74c252af450}\label{class_o_m_sim_s_n_tools_ab44ce4494361d6352987b74c252af450}} 
\index{OMSimSNTools@{OMSimSNTools}!OMSimSNTools@{OMSimSNTools}}
\index{OMSimSNTools@{OMSimSNTools}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{OMSimSNTools()}{OMSimSNTools()}}
{\footnotesize\ttfamily OMSim\+SNTools\+::\+OMSim\+SNTools (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\mbox{\Hypertarget{class_o_m_sim_s_n_tools_aa8369c8d49524201977f48fa5eb20f48}\label{class_o_m_sim_s_n_tools_aa8369c8d49524201977f48fa5eb20f48}} 
\index{OMSimSNTools@{OMSimSNTools}!````~OMSimSNTools@{$\sim$OMSimSNTools}}
\index{````~OMSimSNTools@{$\sim$OMSimSNTools}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{$\sim$OMSimSNTools()}{~OMSimSNTools()}}
{\footnotesize\ttfamily OMSim\+SNTools\+::$\sim$\+OMSim\+SNTools (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a0b663ee3b96216ee943a681a496dffc5}\label{class_o_m_sim_s_n_tools_a0b663ee3b96216ee943a681a496dffc5}} 
\index{OMSimSNTools@{OMSimSNTools}!checkVolumeForOMs@{checkVolumeForOMs}}
\index{checkVolumeForOMs@{checkVolumeForOMs}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{checkVolumeForOMs()}{checkVolumeForOMs()}}
{\footnotesize\ttfamily bool OMSim\+SNTools\+::check\+Volume\+For\+OMs (\begin{DoxyParamCaption}\item[{G4\+Three\+Vector}]{p\+Position }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

This method determines whether the provided position lies in the generation medium (ice) It evaluates the position in the context of the global environment and examines the history depth to make this determination.


\begin{DoxyParams}{Parameters}
{\em p\+Position} & The 3D position vector to be checked against module boundaries. \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
This relies on the generation module being a single volume (generally, the ice) and the mother volume of everything else If the ice is modified to be composed of different subvolumes (like, for example, if the bubble column is added) this method would need to be modify!
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
True if the position is inside a module; otherwise, false. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a704058ea142089a962a89b3dae706aa8}\label{class_o_m_sim_s_n_tools_a704058ea142089a962a89b3dae706aa8}} 
\index{OMSimSNTools@{OMSimSNTools}!findTime@{findTime}}
\index{findTime@{findTime}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{findTime()}{findTime()}}
{\footnotesize\ttfamily G4int OMSim\+SNTools\+::find\+Time (\begin{DoxyParamCaption}\item[{G4double}]{p\+Time,  }\item[{std\+::vector$<$ G4double $>$}]{p\+Time\+Array }\end{DoxyParamCaption})}

This method is utilized to identify neutrino parameters corresponding to a randomly sampled time. These identified parameters are subsequently interpolated to ensure that the model doesn\textquotesingle{}t rely solely on fixed tabulated values from the input neutrino model.


\begin{DoxyParams}{Parameters}
{\em p\+Time} & The reference value for which a close match is sought in the array. \\
\hline
{\em p\+Time\+Array} & The array in which to search for the closest match. \\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000013}{Todo}}]Consider renaming \textquotesingle{}time\textquotesingle{} to a more generic term. \end{DoxyRefDesc}
\begin{DoxyReturn}{Returns}
The index in the array that holds the value closest (or next largest) to the specified input. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_aeb59462c439834b0bb9c5a5be3ad612c}\label{class_o_m_sim_s_n_tools_aeb59462c439834b0bb9c5a5be3ad612c}} 
\index{OMSimSNTools@{OMSimSNTools}!getAlpha@{getAlpha}}
\index{getAlpha@{getAlpha}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{getAlpha()}{getAlpha()}}
{\footnotesize\ttfamily G4double OMSim\+SNTools\+::get\+Alpha (\begin{DoxyParamCaption}\item[{G4double}]{p\+Mean\+Energy,  }\item[{G4double}]{p\+Mean\+ESquared }\end{DoxyParamCaption})}

Given the mean energy and squared mean energy of the neutrino event, calculates the pinching parameter following equation 3 in Irene Tamborra et al., \char`\"{}\+High-\/resolution supernova neutrino spectra represented by a simple fit,\char`\"{} PHYSICAL REVIEW D 86, 125031 (2012). \href{https://arxiv.org/abs/1211.3920}{\texttt{ https\+://arxiv.\+org/abs/1211.\+3920}}


\begin{DoxyParams}{Parameters}
{\em p\+Mean\+Energy} & The primary mean energy value from the supernova model. \\
\hline
{\em p\+Mean\+ESquared} & The primary squared mean energy value from the supernova model. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pinching parameter of the energy spectrum. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a89a22f20d0aff91704cf6cab1b48d266}\label{class_o_m_sim_s_n_tools_a89a22f20d0aff91704cf6cab1b48d266}} 
\index{OMSimSNTools@{OMSimSNTools}!getFileNames@{getFileNames}}
\index{getFileNames@{getFileNames}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{getFileNames()}{getFileNames()}}
{\footnotesize\ttfamily std\+::pair$<$ std\+::string, std\+::string $>$ OMSim\+SNTools\+::get\+File\+Names (\begin{DoxyParamCaption}\item[{int}]{value }\end{DoxyParamCaption})}

This function provides the corresponding file names for neutrino and antineutrino fluxes depending on the supernova model identified by the input value. Files are located in \char`\"{}supernova/models\char`\"{}


\begin{DoxyParams}{Parameters}
{\em value} & The integer identifier representing a specific supernova model. \\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000011}{Todo}}]Handle error cases more robustly than just console output. \end{DoxyRefDesc}
\begin{DoxyReturn}{Returns}
A pair containing the neutrino and antineutrino flux file names. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a82b3eb18b59eba3907a73216050ca5a5}\label{class_o_m_sim_s_n_tools_a82b3eb18b59eba3907a73216050ca5a5}} 
\index{OMSimSNTools@{OMSimSNTools}!inverseCDFmethod@{inverseCDFmethod}}
\index{inverseCDFmethod@{inverseCDFmethod}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{inverseCDFmethod()}{inverseCDFmethod()}}
{\footnotesize\ttfamily G4double OMSim\+SNTools\+::inverse\+CDFmethod (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ G4double $>$ \&}]{pX,  }\item[{const std\+::vector$<$ G4double $>$ \&}]{pY,  }\item[{const std\+::vector$<$ G4double $>$ \&}]{p\+Slopes,  }\item[{const std\+::vector$<$ G4double $>$ \&}]{p\+CDF }\end{DoxyParamCaption})}

This method employs the inverse cumulative distribution function (Inverse CDF) technique to derive samples from a specified distribution. It\textquotesingle{}s useful for generating random values in accordance with the underlying distribution shape.


\begin{DoxyParams}{Parameters}
{\em pX} & The pX values representing the distribution\textquotesingle{}s domain. \\
\hline
{\em pY} & The corresponding y values, or f(p\+X), representing the distribution\textquotesingle{}s values. \\
\hline
{\em p\+Slopes} & The slopes of the f(p\+X) curve, usually derived from the get\+Slopes method. \\
\hline
{\em p\+CDF} & The cumulative values of f(p\+X), usually derived from the get\+Slopes method. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A randomly selected p\+X-\/value sampled in line with the provided distribution. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a86811883d92fdbaf0627b85fde379c43}\label{class_o_m_sim_s_n_tools_a86811883d92fdbaf0627b85fde379c43}} 
\index{OMSimSNTools@{OMSimSNTools}!linearInterpolation@{linearInterpolation}}
\index{linearInterpolation@{linearInterpolation}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{linearInterpolation()}{linearInterpolation()}}
{\footnotesize\ttfamily G4double OMSim\+SNTools\+::linear\+Interpolation (\begin{DoxyParamCaption}\item[{G4double}]{x,  }\item[{G4double}]{x1,  }\item[{G4double}]{x2,  }\item[{G4double}]{y1,  }\item[{G4double}]{y2 }\end{DoxyParamCaption})}

This method calculates the y-\/value for a given x-\/value based on linear interpolation between two known data points (x1, y1) and (x2, y2).


\begin{DoxyParams}{Parameters}
{\em x} & The x-\/value for which the y-\/value is desired. \\
\hline
{\em x1} & The x-\/value of the first data point. \\
\hline
{\em x2} & The x-\/value of the second data point. \\
\hline
{\em y1} & The y-\/value corresponding to x1. \\
\hline
{\em y2} & The y-\/value corresponding to x2. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The interpolated y-\/value for the given pX based on the two provided data points. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a7e746f08979e8ead130088b7396871a1}\label{class_o_m_sim_s_n_tools_a7e746f08979e8ead130088b7396871a1}} 
\index{OMSimSNTools@{OMSimSNTools}!randomPosition@{randomPosition}}
\index{randomPosition@{randomPosition}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{randomPosition()}{randomPosition()}}
{\footnotesize\ttfamily G4\+Three\+Vector OMSim\+SNTools\+::random\+Position (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

The vertex is considered valid only if it is located within the ice, ensuring it is not situated inside the module or other predefined volumes.

\begin{DoxyReturn}{Returns}
A valid vertex position within the ice. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a48caade81da87bfc2a0ac9da94b57110}\label{class_o_m_sim_s_n_tools_a48caade81da87bfc2a0ac9da94b57110}} 
\index{OMSimSNTools@{OMSimSNTools}!sampleEnergy@{sampleEnergy}}
\index{sampleEnergy@{sampleEnergy}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{sampleEnergy()}{sampleEnergy()}}
{\footnotesize\ttfamily G4double OMSim\+SNTools\+::sample\+Energy (\begin{DoxyParamCaption}\item[{G4double}]{p\+Mean\+Energy,  }\item[{G4double}]{p\+Mean\+ESquared,  }\item[{G4double \&}]{p\+Alpha }\end{DoxyParamCaption})}

Build the energy distribution Fe(\+E) given the input parameters, and uses the inverse CDF algorithm to sample a value for the neutrino energy from Fe(\+E). The method prepares the data to use \textquotesingle{}energy\+Distribution\+Vector\textquotesingle{}


\begin{DoxyParams}{Parameters}
{\em p\+Mean\+Energy} & The primary mean energy value from the supernova model. \\
\hline
{\em p\+Mean\+ESquared} & The primary squared mean energy value from the supernova model. \\
\hline
{\em p\+Alpha} & Pinching parameter of the energy spectrum. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The sampled energy value based on the given model. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_afe3ad7c2e7664ff456a98e13b394d17d}\label{class_o_m_sim_s_n_tools_afe3ad7c2e7664ff456a98e13b394d17d}} 
\index{OMSimSNTools@{OMSimSNTools}!sampleValueFromDistribution@{sampleValueFromDistribution}}
\index{sampleValueFromDistribution@{sampleValueFromDistribution}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{sampleValueFromDistribution()}{sampleValueFromDistribution()}}
{\footnotesize\ttfamily G4double OMSim\+SNTools\+::sample\+Value\+From\+Distribution (\begin{DoxyParamCaption}\item[{std\+::vector$<$ G4double $>$}]{p\+Xvals,  }\item[{std\+::vector$<$ G4double $>$}]{p\+Yvals,  }\item[{G4int}]{p\+Nr\+Points }\end{DoxyParamCaption})}

This method preprocesses the provided data and leverages the inverse cumulative distribution function (Inverse CDF) to obtain samples from a specified distribution. It facilitates the generation of random values that adhere to the characteristics of the given distribution.


\begin{DoxyParams}{Parameters}
{\em p\+Xvals} & The pX values representing the domain of the distribution. \\
\hline
{\em p\+Yvals} & The corresponding y values representing the distribution\textquotesingle{}s actual values. \\
\hline
{\em p\+Nr\+Points} & The number of data points in the distribution. \\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000012}{Todo}}]Reconsider the requirement for the \textquotesingle{}p\+Nr\+Points\textquotesingle{} parameter. \end{DoxyRefDesc}
\begin{DoxyReturn}{Returns}
A randomly chosen x-\/value that\textquotesingle{}s sampled based on the distribution\textquotesingle{}s profile. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a518a596145fbc96c4cfe153e60bd7f7e}\label{class_o_m_sim_s_n_tools_a518a596145fbc96c4cfe153e60bd7f7e}} 
\index{OMSimSNTools@{OMSimSNTools}!weight@{weight}}
\index{weight@{weight}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{weight()}{weight()}}
{\footnotesize\ttfamily G4double OMSim\+SNTools\+::weight (\begin{DoxyParamCaption}\item[{G4double}]{p\+Sigma,  }\item[{G4double}]{p\+Nr\+Targets }\end{DoxyParamCaption})}

This method computes the interaction weight of neutrinos in the ice using the formula\+: {\ttfamily weight = p\+Sigma $\ast$ Nt $\ast$ r}, where\+:
\begin{DoxyItemize}
\item {\ttfamily p\+Sigma} is the cross section,
\item {\ttfamily Nt} is the number of targets in the ice (considered as electrons),
\item {\ttfamily r} is the distance the neutrino travels in the ice.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em p\+Sigma} & The cross section value. \\
\hline
{\em p\+Nr\+Targets} & The number of targets present in the ice for the corresponding interaction. \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
It\textquotesingle{}s crucial to note that this formulation is specifically valid for SN neutrinos approaching from the Z axis in a world defined as a cylinder. For any other geometry or conditions, a different approach or adjustments might be required. 
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
The computed interaction weight for the neutrinos based on the provided parameters. 
\end{DoxyReturn}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_o_m_sim_s_n_tools_a9b417d3b2e85de4f1b20e09497a63922}\label{class_o_m_sim_s_n_tools_a9b417d3b2e85de4f1b20e09497a63922}} 
\index{OMSimSNTools@{OMSimSNTools}!mdompos@{mdompos}}
\index{mdompos@{mdompos}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{mdompos}{mdompos}}
{\footnotesize\ttfamily std\+::vector$<$G4double$>$ OMSim\+SNTools\+::mdompos\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{class_o_m_sim_s_n_tools_af908be289d086253893f327f7463d793}\label{class_o_m_sim_s_n_tools_af908be289d086253893f327f7463d793}} 
\index{OMSimSNTools@{OMSimSNTools}!Rmin@{Rmin}}
\index{Rmin@{Rmin}!OMSimSNTools@{OMSimSNTools}}
\doxysubsubsection{\texorpdfstring{Rmin}{Rmin}}
{\footnotesize\ttfamily G4double OMSim\+SNTools\+::\+Rmin\hspace{0.3cm}{\ttfamily [private]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{_o_m_sim_s_n_tools_8hh}{OMSim\+SNTools.\+hh}}\item 
\mbox{\hyperlink{_o_m_sim_s_n_tools_8cc}{OMSim\+SNTools.\+cc}}\end{DoxyCompactItemize}
